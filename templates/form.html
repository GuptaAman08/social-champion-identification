 {% extends 'index.html' %} 

 {% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/form.css') }}">
 {% endblock %}
 
 {% block body %}

<div class="container text-center" style="padding: 50px 0px 100px 0px">

    {% if final_ranks is defined %}
    <div class="row">
        <div class="col-sm-12">
                <p>
                    {% for pending_topic in pending_topics %}
                        {{pending_topic.capitalize()}}, 
                    {% endfor %}

                    is not present in the training corpus at the moment. We will revert back shortly! :)
                </p>
            
        </div>
    </div>

    <div class="row">
        <div class="col-sm-4">
            <h2>Filters</h2>
            <select class="list-group" id="sbOne" multiple="multiple">
                <option class="list-group-item" value="likes">Likes</option>
                <option class="list-group-item" value="retweets">Retweets</option>
                <option class="list-group-item" value="urls">URL</option>
                <option class="list-group-item" value="topic_relevance">Topic Relevance</option>
                <option class="list-group-item" value="hashtags">Hashtags</option>
                <option class="list-group-item" value="sentiment">Sentiment</option>
            </select>

            <select class="" id="sbTwo" multiple="multiple"></select>
            <br>
                    
        <div class="btn-group">
            <input class="btn btn-secondary" type="button" id="left" value="<"/>
            <input class="btn btn-secondary" type="button" id="right" value=">"/>
            <input class="btn btn-secondary" type="button" id="leftall" value="<<"/>
            <input class="btn btn-secondary" type="button" id="rightall" value=">>"/>
        </div>
        <input class="btn btn-success" type="button" value="Filter" id="submit" />
    </div>

    <div class="col-sm-8">
        <h2>Leaderboard</h2>
        {% for data in final_ranks %}
        <h3 class="query">{{data['query'].capitalize()}}</h3>
        <table class="table table-striped leaderboard">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Rank</th>
                </tr>
            </thead>
            <tbody>


                {% for dict_item in data['rank_list'] %}
                <tr>
                    <td>{{dict_item['name']}}</td>
                    <td>{{dict_item['rank']}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endfor %}
    </div>
</div>

{% else %}
<h1>Please Enter a query to get the leaderboard.</h1>
{% endif %}



</div>

<script>
    $(function () {
        function moveItems(origin, dest) {
            $(origin).find(':selected').appendTo(dest);
        }

        function moveAllItems(origin, dest) {
            $(origin).children().appendTo(dest);
        }

        $('#left').click(function () {
            moveItems('#sbTwo', '#sbOne');
        });

        $('#right').on('click', function () {
            moveItems('#sbOne', '#sbTwo');
        });

        $('#leftall').on('click', function () {
            moveAllItems('#sbTwo', '#sbOne');
        });

        $('#rightall').on('click', function () {
            moveAllItems('#sbOne', '#sbTwo');
        });
        $("#queryForm").submit((event) => {
            event.preventDefault()
            let filters = []
            for (var i = 0; i < $('select#sbTwo option').length; i++) {
                filters.push($('select#sbTwo option')[i].value)
            }
            let data = {
                "query": $('#query').val(),
                "filters": filters
            };
            $.redirect('http://localhost:8000/rank', data);
        });
    });

</script> {% endblock %}